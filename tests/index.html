<!DOCTYPE html>
<html>
  <head>
    <title>Tests | Thirteen</title>
    <link rel="stylesheet" href="../node_modules/mocha/mocha.css" />
  </head>
  <body>
    <div id="mocha"></div>
    <script src="../node_modules/mocha/mocha.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sinon@latest/pkg/sinon.js"></script>
    <script type="module">
      import { expect as chaiExpect } from "https://cdn.jsdelivr.net/npm/chai@5.2.0/chai.min.js";
      import { MockLocalStorage, MockAmplitude } from "./mocks.js";
      window.expect = chaiExpect;

      mocha.setup("bdd");

      const storageSandbox = sinon.createSandbox();

      window.mochaHooks = {
        beforeEach() {
          const mockStorage = new MockLocalStorage();
          storageSandbox.stub(window.localStorage, "getItem").callsFake(mockStorage.getItem.bind(mockStorage));
          storageSandbox.stub(window.localStorage, "setItem").callsFake(mockStorage.setItem.bind(mockStorage));
          storageSandbox.stub(window.localStorage, "removeItem").callsFake(mockStorage.removeItem.bind(mockStorage));
          storageSandbox.stub(window.localStorage, "clear").callsFake(mockStorage.clear.bind(mockStorage));

          window.amplitude = new MockAmplitude();
        },
        afterEach() {
          storageSandbox.restore();
        },
      };
    </script>
    <script type="module" src="./game/test_deck.js"></script>
    <script type="module" src="./game/test_game.js"></script>
    <script type="module" src="./game/test_rules.js"></script>
    <script type="module" src="./player/test_base.js"></script>
    <script type="module" src="./player/test_ai.js"></script>
    <script type="module" src="./player/test_human.js"></script>
    <script type="module" src="./player/test_factory.js"></script>
    <script type="module" src="./test_ui.js"></script>
    <script type="module" src="./ai/test_base.js"></script>
    <script type="module" src="./ai/test_combo.js"></script>
    <script type="module" src="./ai/test_highest_card.js"></script>
    <script type="module" src="./ai/test_highest_value.js"></script>
    <script type="module" src="./ai/test_lowest_card.js"></script>
    <script type="module" src="./ai/test_lowest_value.js"></script>
    <script type="module" src="./ai/test_pass.js"></script>
    <script type="module" src="./ai/test_personas.js"></script>
    <script type="module" src="./ai/test_prioritized_combo.js"></script>
    <script type="module" src="./ai/test_random_combo.js"></script>
    <script type="module" src="./ai/test_random.js"></script>
    <script type="module" src="./test_app.js"></script>
    <script type="module" src="./test_analytics.js"></script>
    <script type="module">
      mocha.run();
    </script>
  </body>
</html>
